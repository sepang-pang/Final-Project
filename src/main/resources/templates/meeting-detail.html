<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title> ëª¨ì„ ìƒì„¸ ì¡°íšŒ í˜ì´ì§€ </title>

    <!--ì‚¬ì´íŠ¸ ê¸°ë³¸ì„¤ì •-->
    <meta name="description" content="ëª¨ì„ ìƒì„¸ í˜ì´ì§€">
    <meta name="keywords" content="ëª¨ì„">
    <meta name="author" content="ì˜¤ì„¸ì°½">

    <!--Viewport-->
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum=scale=1.0, minimum=scale=1.0">

    <!--(IE10)-->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <!-- Normalize -->
    <link rel="stylesheet" href='https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css'>

    <!--load CSS-->
    <link rel="stylesheet" href="/css/meeting-detail.css"> <!-- ì„œë²„ ëŒë¦´ ë–„ëŠ” ../static ë¹¼ì•¼ë¨ -->
</head>

<body>
<div class="body-container">
    <!-- í—¤ë” ì˜ì—­: ë¡œê·¸ì•„ì›ƒ, í”„ë¡œí•„ ë²„íŠ¼ í¬í•¨ -->
    <div class="header">
        <button class="logout-btn">ë¡œê·¸ì•„ì›ƒ</button>
        <button class="profile-btn">ë‚´ í”„ë¡œí•„</button>
    </div>

    <!-- ìƒì„¸ ì •ë³´ ì˜ì—­: ëª¨ì„ ì •ë³´, ìˆ˜ì •/ì‚­ì œ ë²„íŠ¼ ë“± í¬í•¨ -->
    <div class="container">

        <!-- ëª¨ì„ ìƒì„¸ ì •ë³´ -->
        <div class="left-content">
            <article class="detail-info">
                <h1 id="meeting-title">ëª¨ì„ íƒ€ì´í‹€</h1>
                <p>ì¼ì‹œ <span id="meeting-date"></span></p>
                <p>ì¥ì†Œ <span id="meeting-place"></span></p>
                <p>ìƒíƒœ <span id="meeting-status"></span></p>
                <p>ì¸ì› <span id="meeting-members"></span> / <span id="max-members"></span></p>
                <button id="participate-btn">ì°¸ì—¬í•˜ê¸°</button>
                <button id="close-btn" style="display:none;">ë§ˆê°í•˜ê¸°</button>
            </article>
        </div>

        <!-- ëª¨ì„ ìˆ˜ì • ë° ì‚­ì œ ë²„íŠ¼ -->
        <div class="right-content">
            <button id="edit-btn">ìˆ˜ì •í•˜ê¸°</button>
            <button id="delete-btn">ì‚­ì œí•˜ê¸°</button>
        </div>
    </div>


    <!-- ì°¸ì—¬ ë©¤ë²„ ì •ë³´ ì˜ì—­: ì°¸ì—¬í•œ ë©¤ë²„ì˜ í”„ë¡œí•„ ì‚¬ì§„ ë° ì´ë¦„ -->
    <article class="member-info">
        <div class="member-card">
            <img src="profile.jpg" alt="í”„ë¡œí•„ ì‚¬ì§„">
            <p>ìœ ì €ì˜ ì´ë¦„</p>
        </div>
        <!-- ì¶”ê°€ ë©¤ë²„ ì¹´ë“œê°€ ì´ ìœ„ì¹˜ì— ì‚½ì…ë  ì˜ˆì • -->
        <!-- JS 218 ~ 221 ë¼ì¸ì— ì–‘ì‹ì´ ìˆìŒ -->
    </article>

    <!-- ëª¨ì„ ë‚´ìš© ì •ë³´ ì˜ì—­: ëª¨ì„ ê´€ë ¨ ì‚¬ì§„ ë° ìƒì„¸ ë‚´ìš© -->
    <article class="content-info">
        <div class="photo">
            <img src="ì´ë¯¸ì§€_ë§í¬" alt="ì´ë¯¸ì§€ ì„¤ëª…">
        </div>
        <div class="description">ëª¨ì„ì˜ ìƒì„¸ì§€ ë‚´ìš©</div>
    </article>

    <!-- ëŒ“ê¸€ ì˜ì—­: ëŒ“ê¸€ ì¹´ìš´íŠ¸, ëŒ“ê¸€ ì…ë ¥ë€ ë° ëŒ“ê¸€ ë¦¬ìŠ¤íŠ¸ -->
    <article class="comments-info">
        <div class="comments-header">
            <span class="comments-count-text">ëŒ“ê¸€</span> <span class="comments-count">0</span>
        </div>

        <!-- ëŒ“ê¸€ ì…ë ¥ ì„¹ì…˜ -->
        <div class="input-section" id="comment-form">
            <textarea placeholder="ëŒ“ê¸€ì„ ì…ë ¥í•˜ì„¸ìš”"></textarea>
            <button id="submit-comment-btn">ë“±ë¡</button>
        </div>

        <!-- ëŒ“ê¸€ ë¦¬ìŠ¤íŠ¸ -->
        <div class="comments-list">
            <!-- ëŒ“ê¸€ì´ ì´ ìœ„ì¹˜ì— ì‚½ì…ë  ì˜ˆì • -->
            <!-- JS 300 ~ 312 ë¼ì¸ì— ì–‘ì‹ì´ ìˆìŒ -->
        </div>
    </article>
</div>

<!-- í‘¸í„° ì˜ì—­: ì£¼ê´€, íŒ€, ë©¤ë²„, ì—°ë½ì²˜ ì •ë³´ í¬í•¨ -->
<footer>
    <div class="footer-content">
        <div class="footer-section">
            <h4>ì£¼ê´€</h4>
            <p>ìŠ¤íŒŒë¥´íƒ€ ì½”ë”©í´ëŸ½</p>
        </div>
        <div class="footer-section">
            <h4>íŒ€</h4>
            <p>ë–¡ìë§ˆì„ ë°©ë²”ëŒ€</p>
        </div>
        <div class="footer-section">
            <h4>ë©¤ë²„</h4>
            <p>ì˜¤ì„¸ì°½, ê³ ì€ë¹„, ê¹€ë™í™˜, ì´ê²½ì›</p>
        </div>
        <div class="footer-section">
            <h4>ë¬¸ì˜ ë©”ì¼</h4>
            <p><a href="mailto:tpckd0533@naver.com">tpckd0533@naver.com</a></p>
        </div>
    </div>
</footer>

<script th:inline="javascript">
    window.onload = function () {

        // -------------- ë°ì´í„° ì´ˆê¸°í™”  -------------- //
        const meetingId = [[${meetingId}]];
        const username = [[${username}]];
        const meetingUsername = [[${meetingUsername}]];
        const clubUsername = [[${clubUsername}]];

        fetchData(meetingId);
        fetchMeetingUsers(meetingId);
        checkAttendStatus(); // ì²´í¬ ì°¸ì„ ìƒíƒœ

        // "ë§ˆê°í•˜ê¸°" ë²„íŠ¼ ì²˜ë¦¬
        if (username === meetingUsername) {
            document.getElementById('close-btn').style.display = "inline-block"; // ëª¨ì„ ì‘ì„±ìë¼ë©´ "ë§ˆê°í•˜ê¸°" ë²„íŠ¼ í‘œì‹œ
        }

        // "ìˆ˜ì •í•˜ê¸°"ì™€ "ì‚­ì œí•˜ê¸°" ë²„íŠ¼ ì²˜ë¦¬
        const editButton = document.getElementById('edit-btn');
        const deleteButton = document.getElementById('delete-btn');
        if (username === meetingUsername) {
            editButton.style.display = "inline-block"; // ëª¨ì„ ì‘ì„±ìë¼ë©´ "ìˆ˜ì •í•˜ê¸°"ì™€ "ì‚­ì œí•˜ê¸°" ë²„íŠ¼ì„ í‘œì‹œí•©ë‹ˆë‹¤.
            deleteButton.style.display = "inline-block";
        } else {
            editButton.style.display = "none"; // ëª¨ì„ ì‘ì„±ìê°€ ì•„ë‹ˆë¼ë©´ "ìˆ˜ì •í•˜ê¸°"ì™€ "ì‚­ì œí•˜ê¸°" ë²„íŠ¼ì„ ìˆ¨ê¹ë‹ˆë‹¤.
            deleteButton.style.display = "none";
        }

        // "ìˆ˜ì •í•˜ê¸°" ë²„íŠ¼ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
        document.getElementById("edit-btn").addEventListener("click", function() {
            // í˜ì´ì§€ ì´ë™
            window.location.href = `/api/meetings/meeting-update/${meetingId}`;
        });

        let isMeetingCompleted = false;  // ëª¨ì„ì´ ë§ˆê°ë˜ì—ˆëŠ”ì§€ ì—¬ë¶€ë¥¼ ì €ì¥í•˜ëŠ” ë³€ìˆ˜

        // -------------- í”„ë¡œí•„ ë²„íŠ¼ í´ë¦­ ì‹œ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ  -------------- //
        document.querySelector('.profile-btn').addEventListener('click', function () {
            window.location.href = "/api/my-profile";
        });


        // -------------- ëª¨ì„ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°  -------------- //
        function fetchData(meetingId) {
            fetch(`/api/meetings/${meetingId}`)
                .then(response => {
                    if (!response.ok) {
                        throw new Error("Network response was not ok");
                    }
                    return response.json();
                })
                .then(data => {
                    displayData(data);
                    fetchComments();

                    isMeetingCompleted = data.isCompleted; // ê°’ì„ ì „ì—­ ë³€ìˆ˜ì— ì €ì¥

                })
                .catch(error => {
                    console.error("There was a problem with the fetch operation:", error.message);
                });
        }


        // -------------- ëª¨ì„ ë°ì´í„° í‘œì‹œ  -------------- //
        function displayData(data) {
            document.getElementById('meeting-title').textContent = data.title;
            document.getElementById('meeting-date').textContent = data.dateDetail;
            document.getElementById('meeting-place').textContent = data.place;
            document.getElementById('meeting-members').textContent = data.memberCount;
            document.getElementById('max-members').textContent = data.maxMember;
            document.getElementById('meeting-status').textContent = data.isCompleted ? "ë§ˆê°" : "ëª¨ì§‘ì¤‘";
            document.querySelector('.description').textContent = data.description;
            document.querySelector('.photo img').src = data.media;
        }

        document.getElementById("submit-comment-btn").addEventListener("click", submitComment);


        function fetchMeetingUsers(meetingId) {
            fetch(`/api/meetings/${meetingId}/members`)
                .then(response => {
                    if (!response.ok) {
                        throw new Error("Failed to fetch meeting members");
                    }
                    return response.json();
                })
                .then(members => {
                    displayMeetingUsers(members);
                })
                .catch(error => {
                    console.error("Error fetching meeting members:", error);
                });
        }

        function displayMeetingUsers(members) {
            const memberContainer = document.querySelector('.member-info');
            // ê¸°ì¡´ì˜ member-cardë¥¼ ì‚­ì œí•©ë‹ˆë‹¤ (ê¸°ì¡´ì— ìˆëŠ” member-cardê°€ ìˆë‹¤ë©´).
            memberContainer.innerHTML = '';

            members.forEach(member => {
                let nicknameText = member.nickname;

                if (meetingUsername === member.username && clubUsername === member.username) {
                    // ë™í˜¸íšŒì¥ì´ë©´ì„œ íšŒì˜ ì£¼ì¸ì¼ ê²½ìš°
                    nicknameText += " ğŸ‘‘ ğŸŒŸ";
                } else if (meetingUsername === member.username) {
                    // íšŒì˜ ì£¼ì¸ì¼ ê²½ìš°
                    nicknameText += " ğŸŒŸ";
                } else if (clubUsername === member.username) {
                    // ë™í˜¸íšŒì¥ì¼ ê²½ìš°
                    nicknameText += " ğŸ‘‘";
                }

                const memberCardHTML = `
           <div class="member-card" data-user-id="${member.userId}">
                <img src="${member.profileImage}" alt="í”„ë¡œí•„ ì‚¬ì§„">
                <p>${nicknameText}</p>
            </div>
                    `;

                memberContainer.innerHTML += memberCardHTML;
            });



        // ëª¨ë“  member-cardì— í´ë¦­ ì´ë²¤íŠ¸ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.
            document.querySelectorAll('.member-card').forEach(card => {
                card.addEventListener('click', function() {
                    // ì¹´ë“œì˜ data-user-id ê°’ì„ ê°€ì ¸ì™€ì„œ URLì„ ìƒì„±í•©ë‹ˆë‹¤.
                    const userId = this.getAttribute('data-user-id');
                    window.location.href = `/api/profile/${userId}`;
                });
            });

        }

        // -------------- ëŒ“ê¸€ ì œì¶œ ê¸°ëŠ¥  -------------- //
        function submitComment() {
            const commentForm = document.getElementById("comment-form");
            const content = commentForm.querySelector("textarea").value;

            if (content.trim() === "") {
                alert("ì…ë ¥ëœ ëŒ“ê¸€ì´ ì—†ìŠµë‹ˆë‹¤.");
                return;
            }

            const commentRequestDto = {
                meetingId: meetingId,
                content: content
            };

            fetch('/api/comments', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(commentRequestDto)
            })
                .then(response => {
                    if (!response.ok) {
                        throw new Error("Failed to submit comment");
                    }
                    return response.json();
                })
                .then(data => {
                    alert("ëŒ“ê¸€ì„ ì‘ì„±í•˜ì˜€ìŠµë‹ˆë‹¤.");
                    location.reload();
                })
                .catch(error => {
                    console.error('Error:', error);
                    alert('ëŒ“ê¸€ ì‘ì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
                });
        }

        // -------------- ëŒ“ê¸€ ê°€ì ¸ì˜¤ê¸°  -------------- //
        function fetchComments() {
            fetch(`/api/meetings/${meetingId}/comments`)
                .then(response => {
                    if (!response.ok) {
                        throw new Error("Failed to fetch comments");
                    }
                    return response.json();
                })
                .then(comments => {
                    displayComments(comments);
                })
                .catch(error => {
                    console.error("Error fetching comments:", error);
                });
        }

        // -------------- ëŒ“ê¸€ ìš”ì†Œ ìƒì„±  -------------- //
        function createCommentElement(comment) {
            const commentElement = document.createElement('div');
            commentElement.classList.add('comment');
            commentElement.dataset.commentId = comment.commentId;
            const commentHTML = `
        <div class="comment-text">
            <p class="original-comment-text">${comment.content}</p>
            <textarea class="edit-textarea" style="display: none;"></textarea>
            <span class="username">${comment.nickname}</span>
            <span class="create_time">${new Date(comment.createAt).toLocaleString()}</span>
        </div>
        <div class="comment-buttons">
            <button class="edit-button">ìˆ˜ì •</button>
            <button class="save-edit-button" style="display: none;">ì™„ë£Œ</button>
            <button class="cancel-edit-button" style="display: none;">ì·¨ì†Œ</button>
            <button class="delete-button">ì‚­ì œ</button>
            <button class="like-button">ì¢‹ì•„ìš” (${comment.likesCount || 0})</button>
        </div>
    `;
            commentElement.innerHTML = commentHTML;
            commentElement.querySelector('.edit-button').addEventListener('click', function () {
                showEditCommentForm(commentElement, comment);
            });
            return commentElement;
        }

        // -------------- ëŒ“ê¸€ ìˆ˜ì • í¼ í‘œì‹œ  -------------- //
        function showEditCommentForm(commentElement, comment) {
            const originalCommentElements = commentElement.querySelectorAll('.original-comment-text, .username, .create_time, .edit-button, .delete-button, .like-button');
            const editElements = commentElement.querySelectorAll('.edit-textarea, .save-edit-button, .cancel-edit-button');

            originalCommentElements.forEach(el => el.style.display = 'none');
            editElements.forEach(el => el.style.display = 'inline-block');

            const editArea = commentElement.querySelector('.edit-textarea');
            editArea.value = comment.content;
        }

        // -------------- ëŒ“ê¸€ í‘œì‹œ  -------------- //
        function displayComments(comments) {
            const commentsContainer = document.querySelector('.comments-list');
            commentsContainer.innerHTML = '';
            comments.forEach(comment => {
                const commentElement = createCommentElement(comment);
                commentsContainer.appendChild(commentElement);
            });
            const countElement = document.querySelector('.comments-count');
            countElement.textContent = comments.length;
        }

        // -------------- ëŒ“ê¸€ ì•¡ì…˜ì— ëŒ€í•œ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ -------------- //
        document.body.addEventListener('click', function (event) {
            const commentElement = event.target.closest('.comment');

            if (!commentElement) return;  // ëŒ“ê¸€ ìš”ì†Œë¥¼ ì°¾ì§€ ëª»í•˜ë©´ ì•„ë¬´ê²ƒë„ í•˜ì§€ ì•ŠëŠ”ë‹¤.


            if (event.target.classList.contains('save-edit-button')) {
                const commentId = commentElement.dataset.commentId;
                const editArea = commentElement.querySelector('.edit-textarea');
                const updatedContent = editArea.value;

                if (updatedContent.trim() === "") {
                    alert("ì…ë ¥ëœ ëŒ“ê¸€ì´ ì—†ìŠµë‹ˆë‹¤.");
                    return;
                }

                fetch(`/api/comments/${commentId}`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({content: updatedContent})
                })
                    .then(response => {
                        if (response.ok) {
                            alert('ëŒ“ê¸€ ìˆ˜ì • ì™„ë£Œ!');
                            location.reload();
                        } else {
                            alert('ë³¸ì¸ ëŒ“ê¸€ì´ ì•„ë‹™ë‹ˆë‹¤.');
                            location.reload();
                        }
                    });
            } else if (event.target.classList.contains('cancel-edit-button')) {
                revertToOriginalCommentForm(commentElement);
            }

            // ì—¬ê¸°ì— 'delete-button' ì²˜ë¦¬ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.
            else if (event.target.classList.contains('delete-button')) {
                const confirmation = confirm("ëŒ“ê¸€ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?");
                if (confirmation) {
                    const commentId = commentElement.dataset.commentId;
                    fetch(`/api/comments/${commentId}`, {
                        method: 'DELETE'
                    })
                        .then(response => response.json())
                        .then(data => {
                            if (data.statusCode === 200) {
                                alert('ëŒ“ê¸€ ì‚­ì œ ì™„ë£Œ!');
                                location.reload();
                            } else {
                                alert('ë³¸ì¸ ëŒ“ê¸€ì´ ì•„ë‹™ë‹ˆë‹¤.');
                            }
                        });
                }
            } else if (event.target.classList.contains('like-button')) {
                const commentId = commentElement.dataset.commentId;
                fetch(`/api/comments/${commentId}/like-status`, {
                    method: 'GET'
                })
                    .then(response => response.json())
                    .then(isLiked => {
                        if (isLiked) {
                            return fetch(`/api/comments/${commentId}/dislike`, {
                                method: 'DELETE'
                            });
                        } else {
                            return fetch(`/api/comments/${commentId}/like`, {
                                method: 'POST'
                            });
                        }
                    })
                    .then(response => response.json())
                    .finally(() => {
                        location.reload();
                    });
            }
        });

        function revertToOriginalCommentForm(commentElement) {
            const originalCommentText = commentElement.querySelector('.original-comment-text');
            const editArea = commentElement.querySelector('.edit-textarea');
            const editButton = commentElement.querySelector('.edit-button');
            const deleteButton = commentElement.querySelector('.delete-button');
            const likeButton = commentElement.querySelector('.like-button');
            const saveButton = commentElement.querySelector('.save-edit-button');
            const cancelButton = commentElement.querySelector('.cancel-edit-button');

            originalCommentText.style.display = 'block'; // ì›ë˜ ëŒ“ê¸€ ë³´ì´ê¸°
            editArea.style.display = 'none'; // edit textarea ìˆ¨ê¸°ê¸°
            editButton.style.display = 'inline-block'; // edit ë²„íŠ¼ ë³´ì´ê¸°
            deleteButton.style.display = 'inline-block'; // delete ë²„íŠ¼ ë³´ì´ê¸°
            likeButton.style.display = 'inline-block'; // like ë²„íŠ¼ ë³´ì´ê¸°
            saveButton.style.display = 'none'; // save ë²„íŠ¼ ìˆ¨ê¸°ê¸°
            cancelButton.style.display = 'none'; // cancel ë²„íŠ¼ ìˆ¨ê¸°ê¸°
        }

        function checkAttendStatus() {
            fetch(`/api/meetings/${meetingId}/isAttend`)  // ì´ URLì€ ë‹¹ì‹ ì˜ ì‹¤ì œ API ê²½ë¡œì™€ ì¼ì¹˜í•´ì•¼ í•©ë‹ˆë‹¤.
                .then(response => {
                    if (!response.ok) {
                        throw new Error("Failed to fetch attend status");
                    }
                    return response.json();
                })
                .then(isAttend => {
                    const attendButton = document.querySelector('.detail-info button');
                    attendButton.textContent = isAttend ? "ì°¸ì—¬ì·¨ì†Œ" : "ì°¸ì—¬í•˜ê¸°";
                })
                .catch(error => {
                    console.error("Error fetching attend status:", error);
                });
        }


        document.querySelector('.detail-info button').addEventListener('click', function () {
            const buttonText = this.textContent;

            if (isMeetingCompleted && buttonText === "ì°¸ì—¬í•˜ê¸°") {
                alert("ë§ˆê°ëœ ëª¨ì„ì…ë‹ˆë‹¤.");
                return;
            }

            let requestUrl, requestMethod;

            if (buttonText === "ì°¸ì—¬í•˜ê¸°") {
                requestUrl = `/api/meetings/${meetingId}/attend`;
                requestMethod = "PUT";
                alert("ì°¸ì—¬ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.")
                location.reload();
            } else if (buttonText === "ì°¸ì—¬ì·¨ì†Œ") {
                requestUrl = `/api/meetings/${meetingId}/cancel`;
                requestMethod = "DELETE";
                alert("ì°¸ì—¬ê°€ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤.")
                location.reload();
            } else {
                console.error("Unknown button text:", buttonText);
                return;
            }

            fetch(requestUrl, {
                method: requestMethod,
            })
                .then(response => {
                    if (!response.ok) {
                        throw new Error("Failed to execute action");
                    }
                    return response.json();
                })
                .then(result => {
                    location.reload();
                    checkAttendStatus();  // ì°¸ì—¬ ìƒíƒœë¥¼ ë‹¤ì‹œ í™•ì¸í•˜ì—¬ ë²„íŠ¼ í…ìŠ¤íŠ¸ë¥¼ ì—…ë°ì´íŠ¸ í•©ë‹ˆë‹¤.
                })
                .catch(error => {
                    console.error("Error executing action:", error);
                });
        });

        document.getElementById('close-btn').addEventListener('click', function () {
            fetch(`/api/meetings/${meetingId}/completed`, {
                method: 'PATCH',
                headers: {
                    'Content-Type': 'application/json'
                },
            })
                .then(response => {
                    if (response.ok) {
                        return response.json();
                    } else {
                        throw new Error("Something went wrong");
                    }
                })
                .then(data => {
                    alert("ëª¨ì„ì´ ë§ˆê°ë˜ì—ˆìŠµë‹ˆë‹¤.");
                    location.reload();
                })
                .catch(error => {
                    console.error("There was a problem with the fetch operation:", error.message);
                    alert(error.message);
                });
        });

        // -------------- ëª¨ì„ ì‚­ì œ ê¸°ëŠ¥  -------------- //
        document.getElementById("delete-btn").addEventListener("click", deleteMeeting);

        function deleteMeeting() {
            const confirmation = confirm("ì •ë§ë¡œ ì´ ëª¨ì„ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?");  // ì‚¬ìš©ìì—ê²Œ ì‚­ì œ í™•ì¸

            if (!confirmation) {
                return;  // ì‚¬ìš©ìê°€ ì‚­ì œë¥¼ ì›í•˜ì§€ ì•ŠëŠ”ë‹¤ë©´ ì•„ë¬´ê²ƒë„ í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
            }

            fetch(`/api/meetings/${meetingId}`, {
                method: 'DELETE'
            })
                .then(response => {
                    if (response.ok) {
                        alert('ëª¨ì„ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
                        window.location.href = "/sub-main";

                    } else {
                        return response.json().then(err => {
                            throw err;
                        });
                    }
                })
                .catch(error => {
                    alert('ëª¨ì„ ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
                    console.error('Error:', error);
                });
        }

        // -------------- ë¡œê·¸ì•„ì›ƒ ê¸°ëŠ¥  -------------- //
        document.querySelector('.logout-btn').addEventListener('click', function () {
            fetch('/logout', {
                method: 'POST',
            })
                .then(response => {
                    if (response.ok) {
                        alert('ë¡œê·¸ì•„ì›ƒ ë˜ì—ˆìŠµë‹ˆë‹¤.');
                        window.location.href = "/login";
                    } else {
                        alert('ë¡œê·¸ì•„ì›ƒ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
                    }
                })
                .catch(error => {
                    console.error('Error during logout:', error);
                    alert('ë¡œê·¸ì•„ì›ƒ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
                });
        });

        // -------------- ìˆ˜ì • í˜ì´ì§€ë¡œ ì´ë™  -------------- //
        document.addEventListener("DOMContentLoaded", function() {
            const editButton = document.getElementById("edit-btn");
            const meetingId = [[${meetingId}]]; // Thymeleafë¡œë¶€í„° ë°›ì•„ì˜¨ meetingId

            editButton.addEventListener("click", function() {
                // meetingIdë¥¼ ì‚¬ìš©í•˜ì—¬ ì›í•˜ëŠ” URLë¡œ ë¦¬ë””ë ‰ì…˜í•©ë‹ˆë‹¤.
                window.location.href = `/meeting-update/${meetingId}`;
            });
        });

    };
</script>


</body>
</html>